"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const a=require("vue"),E={a:["class","href","id","style","target"],address:["class","id","style"],b:["class","id","style"],blockquote:["class","id","style"],br:["class","id","style"],caption:["class","id","style"],cite:["class","id","style"],code:["class","id","style"],col:["align","bgcolor","char","charoff","class","id","style","valign","width"],colgroup:["align","bgcolor","char","charoff","class","id","style","valign","width"],center:["class","id","style"],dd:["class","id","style"],div:["align","class","dir","id","style"],dt:["class","id","style"],em:["class","id","style"],font:["class","color","face","id","size","style"],h1:["align","class","dir","id","style"],h2:["align","class","dir","id","style"],h3:["align","class","dir","id","style"],h4:["align","class","dir","id","style"],h5:["align","class","dir","id","style"],h6:["align","class","dir","id","style"],hr:["align","size","width"],i:["class","id","style"],img:["align","alt","border","class","height","hspace","id","src","style","usemap","vspace","width"],label:["class","id","style"],legend:["class","id","style"],li:["class","dir","id","style","type"],ol:["class","dir","id","style","type","start","reversed"],p:["align","class","dir","id","style"],pre:["class","id","style"],span:["class","id","style"],strong:["class","id","style"],style:[],sub:["class","id","style"],sup:["class","id","style"],table:["align","bgcolor","border","cellpadding","cellspacing","class","dir","frame","id","rules","style","width"],tbody:["class","id","style"],td:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],tfoot:["align","bgcolor","char","charoff","class","id","style","valign"],th:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],thead:["align","bgcolol","char","charoff","class","id","style","valign"],tr:["align","bgcolor","char","charoff","class","dir","id","style","valign"],u:["class","id","style"],ul:["class","dir","id","style"]},P=["script","iframe","textarea","title","noscript","noembed","svg"],O=["azimuth","background","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-repeat-x","background-repeat-y","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","box-sizing","break-after","break-before","break-inside","caption-side","clear","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","direction","display","elevation","empty-cells","float","font","font-family","font-feature-settings","font-kerning","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","height","image-orientation","image-resolution","ime-mode","isolation","layout-flow","layout-grid","layout-grid-char","layout-grid-char-spacing","layout-grid-line","layout-grid-mode","layout-grid-type","letter-spacing","line-break","line-height","list-style","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","max-height","max-width","min-height","min-width","mix-blend-mode","object-fit","object-position","opacity","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","pitch","pitch-range","quotes","richness","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","table-layout","text-align","text-align-last","text-autospace","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-style","text-indent","text-justify","text-kashida-space","text-orientation","text-overflow","text-transform","text-underline-position","unicode-bidi","vertical-align","voice-family","white-space","width","word-break","word-spacing","word-wrap","writing-mode","zoom"];function q(t,o){return o?t.split(",").map(l=>l.trim()).map(l=>{const s=l.replace(/\./g,"."+o+"_").replace(/#/g,"#"+o+"_");return s.toLowerCase().startsWith("body")?"#"+o+" "+s.substring(4):"#"+o+" "+s}).join(","):t}function B(t,o,l){return t.trim().replace(/expression\((.*?)\)/g,"").replace(/url\(["']?(.*?)["']?\)/g,(s,n)=>l?`url("${encodeURI(l(decodeURI(n)))}")`:o.includes(n.toLowerCase().split(":")[0])?s:"")}function j(t,o,l,s){if(!t)return;const n=[];for(let r=0;r<t.length;r++){const f=t[r];n.push(f)}for(const r of n)if(O.includes(r)){const f=t.getPropertyValue(r);t.setProperty(r,B(f,o,s),l?t.getPropertyPriority(r):void 0)}else t.removeProperty(r)}function H(t,o,l,s,n){t.selectorText=q(t.selectorText,o),j(t.style,l,s,n)}const S=["http","https","mailto"];function F(t,{dropAllHtmlTags:o=!1,rewriteExternalLinks:l,rewriteExternalResources:s,id:n="msg_"+String.fromCharCode(...new Array(24).fill(void 0).map(()=>Math.random()*25%25+65)),allowedSchemas:r=S,preserveCssPriority:f=!0,noWrapper:h=!1}){var N,_,A,z,M;h&&(n="");const c=new DOMParser().parseFromString(t,"text/html");r=Array.isArray(r)?r.map(e=>e.toLowerCase()):S;const x=c.createNodeIterator(c.documentElement,NodeFilter.SHOW_COMMENT);let d;for(;d=x.nextNode();)(N=d.parentNode)==null||N.removeChild(d);const w=[...P];o&&w.push("style"),c.querySelectorAll(w.join(", ")).forEach(e=>e.remove()),c.querySelectorAll("head > style").forEach(e=>{c.body.appendChild(e)});const C=[],T=c.createNodeIterator(c.body,NodeFilter.SHOW_ELEMENT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(;d=T.nextNode();){const e=d,g=e.tagName.toLowerCase();if(!(g==="body"||g==="html")){if(o){if(d.textContent){const p=c.createTextNode(d.textContent);(_=d.parentNode)==null||_.replaceChild(p,d)}else(A=d.parentNode)==null||A.removeChild(d);continue}if(g in E){const p=E[g];for(const i of e.getAttributeNames())if(!p.includes(i))e.removeAttribute(i);else if(i==="class"&&!h)e.setAttribute(i,((z=e.getAttribute(i))==null?void 0:z.split(" ").map(u=>n+"_"+u).join(" "))??"");else if(i==="id"&&!h)e.setAttribute(i,n+"_"+(e.getAttribute(i)??""));else if(i==="href"||i==="src"){const u=e.getAttribute(i)??"";i==="href"&&l?e.setAttribute(i,l(u)):i==="src"&&s?e.setAttribute(i,s(u)):r.includes(u.toLowerCase().split(":")[0])||e.removeAttribute(i)}j(e.style,r,f,s),g==="a"&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}else e.insertAdjacentHTML("afterend",e.innerHTML),C.push(e)}}for(const e of C)try{try{(M=e.parentNode)==null||M.removeChild(e)}catch{e.outerHTML=""}}catch{try{e.remove()}catch{}}if(c.querySelectorAll("body style").forEach(e=>{const g=e,p=g.sheet,i=[];if(!p.cssRules){g.textContent="";return}for(let u=0;u<p.cssRules.length;u++){const b=p.cssRules[u];if("selectorText"in b)H(b,n,r,f,s),i.push(b);else if("cssRules"in b&&"media"in b){const m=b,R=[];for(let y=0;y<m.cssRules.length;y++){const v=m.cssRules[y];v.type===v.STYLE_RULE&&(H(v,n,r,f,s),R.push(v))}for(;m.cssRules.length>0;)m.deleteRule(0);for(const y of R)m.insertRule(y.cssText,m.cssRules.length);i.push(m)}}g.textContent=i.map(u=>u.cssText).join(`
`)}),h)return c.body.innerHTML;{const e=c.createElement("div");return e.id=n,e.innerHTML=c.body.innerHTML,e.outerHTML}}function U(t){const o=document.createElement("div");return o.textContent=t,o.innerHTML}function V(t,o,l){let s=t??"";return(s==null?void 0:s.length)===0&&o&&(s=U(o).split(`
`).map(n=>"<p>"+n+"</p>").join(`
`)),F(s,l??{})}const D=["innerHTML"],W=["title"],I=a.defineComponent({__name:"Letter",props:{className:{},html:{},text:{},useIframe:{type:Boolean},iframeTitle:{},rewriteExternalLinks:{},rewriteExternalResources:{},allowedSchemas:{},preserveCssPriority:{type:Boolean}},setup(t){const o=t,{className:l,html:s,text:n,useIframe:r,iframeTitle:f,rewriteExternalLinks:h,rewriteExternalResources:c,allowedSchemas:x,preserveCssPriority:d}=a.reactive(o),k=V(s,n,{rewriteExternalResources:c,rewriteExternalLinks:h,allowedSchemas:x,preserveCssPriority:d}),L="data:text/html;charset=utf-8,"+encodeURIComponent(k);return(C,T)=>a.unref(r)?a.unref(r)?(a.openBlock(),a.createElementBlock("div",{key:1,class:a.normalizeClass([a.unref(l)])},[a.createElementVNode("iframe",{src:L,title:a.unref(f)},null,8,W)],2)):a.createCommentVNode("",!0):(a.openBlock(),a.createElementBlock("div",{key:0,class:a.normalizeClass([a.unref(l)]),innerHTML:a.unref(k)},null,10,D))}}),Y={install:t=>{t.component("Letter",I)}};exports.Letter=I;exports.default=Y;
