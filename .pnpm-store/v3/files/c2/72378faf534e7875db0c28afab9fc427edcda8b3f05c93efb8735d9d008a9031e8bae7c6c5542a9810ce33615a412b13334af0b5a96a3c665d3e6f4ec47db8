"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("date-fns/isToday")),n=t(require("date-fns/isYesterday"));function r(t){return t.slice().sort((function(t,e){return t-e}))}function o(t,e,n){return n<t?t:n>e?e:n}function a(t,e){var n=o(0,1,e),r=(t.length-1)*n,a=Math.floor(r);return void 0!==t[a+1]?t[a]+(r-a)*(t[a+1]-t[a]):t[a]}function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var u=/{{(.*?)}}/g,s=function(t){return(t||"").replace(/\b(\w)/g,(function(t){return t.toUpperCase()}))},l=function(t){var e=t.user,n=null!=e&&e.name?e.name.split(" ").shift():"";return s(n)},c=function(t){var e=t.user;if(e&&e.name){var n=e.name.split(" ").length>1?e.name.split(" ").pop():"";return s(n)}return""},f=function(t,e){return null===e?null:t+e-Math.floor(Date.now()/1e3)},d=function(t){var e={y:31536e3,mo:2592e3,d:86400,h:3600,m:60};if(t<60)return"1m";var n=[];return Object.keys(e).forEach((function(r){var o=Math.floor(t/e[r]);t<60&&n.length>0||2!==n.length&&o>0&&(n.push(o+r),t-=o*e[r])})),n.join(" ")};exports.clamp=o,exports.convertSecondsToTimeUnit=function(t,e){return null===t||0===t?{time:"",unit:""}:t<3600?{time:Number((t/60).toFixed(1)),unit:e.minute}:t<86400?{time:Number((t/3600).toFixed(1)),unit:e.hour}:{time:Number((t/86400).toFixed(1)),unit:e.day}},exports.createTypingIndicator=function(t,e,n){var r=null,o=function(){r&&(clearTimeout(r),r=null,e())};return{start:function(){r||t(),r&&clearTimeout(r),r=setTimeout((function(){o()}),n)},stop:o}},exports.debounce=function(t,e,n){var r;return function(){var o=null,a=arguments,i=function(){r=null,n||t.apply(o,a)},u=n&&!r;clearTimeout(r),r=window.setTimeout(i,e),u&&t.apply(o,a)}},exports.evaluateSLAStatus=function(t){var e=t.appliedSla,n=t.chat;if(!e||!n)return{type:"",threshold:"",icon:"",isSlaMissed:!1};var r,o=((r=function(t,e){return["FRT","NRT","RT"].map((function(n){return function(t,e,n){var r=e.sla_first_response_time_threshold,o=e.sla_next_response_time_threshold,a=e.sla_resolution_time_threshold,u=e.created_at,s=n.first_reply_created_at,l=n.waiting_since,c=n.status,d={FRT:{threshold:f(u,r),condition:null!==r&&(!s||0===s)},NRT:{threshold:f(l,o),condition:null!==o&&!!s&&!!l},RT:{threshold:f(u,a),condition:"open"===c&&null!==a}}[t];return d?i({},d,{type:t}):null}(n,t,e)})).filter((function(t){return!!t&&t.condition})).map((function(t){return i({},t,{icon:t.threshold<=0?"flame":"alarm",isSlaMissed:t.threshold<=0})}))}(e,n)).sort((function(t,e){return Math.abs(t.threshold)-Math.abs(e.threshold)})),r[0]);return o?{type:null==o?void 0:o.type,threshold:d(o.threshold<=0?-o.threshold:o.threshold),icon:o.icon,isSlaMissed:o.isSlaMissed}:{type:"",threshold:"",icon:"",isSlaMissed:!1}},exports.formatDate=function(t){var r=t.date,o=t.todayText,a=t.yesterdayText,i=new Date(r);return e(i)?o:n(i)?a:r},exports.formatTime=function(t){var e="";if(t>=60&&t<3600){var n=Math.floor(t/60);e=n+" Min";var r=60===n?0:Math.floor(t%60);return e+(r>0?" "+r+" Sec":"")}if(t>=3600&&t<86400){var o=Math.floor(t/3600);e=o+" Hr";var a=t%3600<60||24===o?0:Math.floor(t%3600/60);return e+(a>0?" "+a+" Min":"")}if(t>=86400){var i=Math.floor(t/86400);e=i+" Day";var u=t%86400<3600||i>=364?0:Math.floor(t%86400/3600);return e+(u>0?" "+u+" Hr":"")}return Math.floor(t)+" Sec"},exports.getContrastingTextColor=function(t){var e=t.replace("#","");return.299*parseInt(e.slice(0,2),16)+.587*parseInt(e.slice(2,4),16)+.114*parseInt(e.slice(4,6),16)>186?"#000000":"#FFFFFF"},exports.getMessageVariables=function(t){var e,n=t.conversation,r=n.meta,o=r.assignee,a=r.sender,u=n.id,f=n.custom_attributes,d=void 0===f?{}:f,p=(t.contact||{}).custom_attributes;return i({},{"contact.name":s((null==a?void 0:a.name)||""),"contact.first_name":l({user:a}),"contact.last_name":c({user:a}),"contact.email":null==a?void 0:a.email,"contact.phone":null==a?void 0:a.phone_number,"contact.id":null==a?void 0:a.id,"conversation.id":u,"agent.name":s((null==o?void 0:o.name)||""),"agent.first_name":l({user:o}),"agent.last_name":c({user:o}),"agent.email":null!=(e=null==o?void 0:o.email)?e:""},Object.entries(null!=d?d:{}).reduce((function(t,e){return t["conversation.custom_attribute."+e[0]]=e[1],t}),{}),Object.entries(null!=p?p:{}).reduce((function(t,e){return t["contact.custom_attribute."+e[0]]=e[1],t}),{}))},exports.getQuantileIntervals=function(t,e){var n=r(t);return e.map((function(t){return a(n,t)}))},exports.getUndefinedVariablesInMessage=function(t){var e=t.variables,n=t.message.replace(/```(?:.|\n)+?```/g,"").match(u);return n?n.map((function(t){return t.replace("{{","").replace("}}","").trim()})).filter((function(t){return void 0===e[t]})):[]},exports.parseBoolean=function(t){try{var e=String(t).toLowerCase();return Boolean(JSON.parse(e))}catch(t){return!1}},exports.quantile=function(t,e){return a(r(t),e)},exports.replaceVariablesInMessage=function(t){var e=t.message,n=t.variables;return null==e?void 0:e.replace(u,(function(t,e){return n[e.trim()]?n[e.trim().toLowerCase()]:""}))},exports.sortAsc=r,exports.trimContent=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=1024),void 0===n&&(n=!1);var r=t;return t.length>e&&(r=t.substring(0,e)),n&&(r+="..."),r};
//# sourceMappingURL=utils.cjs.production.min.js.map
