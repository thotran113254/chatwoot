(function(g,i){typeof exports=="object"&&typeof module<"u"?i(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],i):(g=typeof globalThis<"u"?globalThis:g||self,i(g["vue-letter"]={},g.Vue))})(this,function(g,i){"use strict";const T={a:["class","href","id","style","target"],address:["class","id","style"],b:["class","id","style"],blockquote:["class","id","style"],br:["class","id","style"],caption:["class","id","style"],cite:["class","id","style"],code:["class","id","style"],col:["align","bgcolor","char","charoff","class","id","style","valign","width"],colgroup:["align","bgcolor","char","charoff","class","id","style","valign","width"],center:["class","id","style"],dd:["class","id","style"],div:["align","class","dir","id","style"],dt:["class","id","style"],em:["class","id","style"],font:["class","color","face","id","size","style"],h1:["align","class","dir","id","style"],h2:["align","class","dir","id","style"],h3:["align","class","dir","id","style"],h4:["align","class","dir","id","style"],h5:["align","class","dir","id","style"],h6:["align","class","dir","id","style"],hr:["align","size","width"],i:["class","id","style"],img:["align","alt","border","class","height","hspace","id","src","style","usemap","vspace","width"],label:["class","id","style"],legend:["class","id","style"],li:["class","dir","id","style","type"],ol:["class","dir","id","style","type","start","reversed"],p:["align","class","dir","id","style"],pre:["class","id","style"],span:["class","id","style"],strong:["class","id","style"],style:[],sub:["class","id","style"],sup:["class","id","style"],table:["align","bgcolor","border","cellpadding","cellspacing","class","dir","frame","id","rules","style","width"],tbody:["class","id","style"],td:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],tfoot:["align","bgcolor","char","charoff","class","id","style","valign"],th:["abbr","align","bgcolor","class","colspan","dir","height","id","lang","rowspan","scope","style","valign","width"],thead:["align","bgcolol","char","charoff","class","id","style","valign"],tr:["align","bgcolor","char","charoff","class","dir","id","style","valign"],u:["class","id","style"],ul:["class","dir","id","style"]},O=["script","iframe","textarea","title","noscript","noembed","svg"],q=["azimuth","background","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-repeat-x","background-repeat-y","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","box-sizing","break-after","break-before","break-inside","caption-side","clear","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","direction","display","elevation","empty-cells","float","font","font-family","font-feature-settings","font-kerning","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","height","image-orientation","image-resolution","ime-mode","isolation","layout-flow","layout-grid","layout-grid-char","layout-grid-char-spacing","layout-grid-line","layout-grid-mode","layout-grid-type","letter-spacing","line-break","line-height","list-style","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","max-height","max-width","min-height","min-width","mix-blend-mode","object-fit","object-position","opacity","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","pitch","pitch-range","quotes","richness","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","table-layout","text-align","text-align-last","text-autospace","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-style","text-indent","text-justify","text-kashida-space","text-orientation","text-overflow","text-transform","text-underline-position","unicode-bidi","vertical-align","voice-family","white-space","width","word-break","word-spacing","word-wrap","writing-mode","zoom"];function B(t,o){return o?t.split(",").map(n=>n.trim()).map(n=>{const s=n.replace(/\./g,"."+o+"_").replace(/#/g,"#"+o+"_");return s.toLowerCase().startsWith("body")?"#"+o+" "+s.substring(4):"#"+o+" "+s}).join(","):t}function F(t,o,n){return t.trim().replace(/expression\((.*?)\)/g,"").replace(/url\(["']?(.*?)["']?\)/g,(s,a)=>n?`url("${encodeURI(n(decodeURI(a)))}")`:o.includes(a.toLowerCase().split(":")[0])?s:"")}function N(t,o,n,s){if(!t)return;const a=[];for(let r=0;r<t.length;r++){const f=t[r];a.push(f)}for(const r of a)if(q.includes(r)){const f=t.getPropertyValue(r);t.setProperty(r,F(f,o,s),n?t.getPropertyPriority(r):void 0)}else t.removeProperty(r)}function _(t,o,n,s,a){t.selectorText=B(t.selectorText,o),N(t.style,n,s,a)}const A=["http","https","mailto"];function V(t,{dropAllHtmlTags:o=!1,rewriteExternalLinks:n,rewriteExternalResources:s,id:a="msg_"+String.fromCharCode(...new Array(24).fill(void 0).map(()=>Math.random()*25%25+65)),allowedSchemas:r=A,preserveCssPriority:f=!0,noWrapper:y=!1}){var E,H,j,S,I;y&&(a="");const c=new DOMParser().parseFromString(t,"text/html");r=Array.isArray(r)?r.map(e=>e.toLowerCase()):A;const k=c.createNodeIterator(c.documentElement,NodeFilter.SHOW_COMMENT);let d;for(;d=k.nextNode();)(E=d.parentNode)==null||E.removeChild(d);const v=[...O];o&&v.push("style"),c.querySelectorAll(v.join(", ")).forEach(e=>e.remove()),c.querySelectorAll("head > style").forEach(e=>{c.body.appendChild(e)});const L=[],R=c.createNodeIterator(c.body,NodeFilter.SHOW_ELEMENT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(;d=R.nextNode();){const e=d,p=e.tagName.toLowerCase();if(!(p==="body"||p==="html")){if(o){if(d.textContent){const m=c.createTextNode(d.textContent);(H=d.parentNode)==null||H.replaceChild(m,d)}else(j=d.parentNode)==null||j.removeChild(d);continue}if(p in T){const m=T[p];for(const l of e.getAttributeNames())if(!m.includes(l))e.removeAttribute(l);else if(l==="class"&&!y)e.setAttribute(l,((S=e.getAttribute(l))==null?void 0:S.split(" ").map(u=>a+"_"+u).join(" "))??"");else if(l==="id"&&!y)e.setAttribute(l,a+"_"+(e.getAttribute(l)??""));else if(l==="href"||l==="src"){const u=e.getAttribute(l)??"";l==="href"&&n?e.setAttribute(l,n(u)):l==="src"&&s?e.setAttribute(l,s(u)):r.includes(u.toLowerCase().split(":")[0])||e.removeAttribute(l)}N(e.style,r,f,s),p==="a"&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}else e.insertAdjacentHTML("afterend",e.innerHTML),L.push(e)}}for(const e of L)try{try{(I=e.parentNode)==null||I.removeChild(e)}catch{e.outerHTML=""}}catch{try{e.remove()}catch{}}if(c.querySelectorAll("body style").forEach(e=>{const p=e,m=p.sheet,l=[];if(!m.cssRules){p.textContent="";return}for(let u=0;u<m.cssRules.length;u++){const b=m.cssRules[u];if("selectorText"in b)_(b,a,r,f,s),l.push(b);else if("cssRules"in b&&"media"in b){const h=b,P=[];for(let x=0;x<h.cssRules.length;x++){const w=h.cssRules[x];w.type===w.STYLE_RULE&&(_(w,a,r,f,s),P.push(w))}for(;h.cssRules.length>0;)h.deleteRule(0);for(const x of P)h.insertRule(x.cssText,h.cssRules.length);l.push(h)}}p.textContent=l.map(u=>u.cssText).join(`
`)}),y)return c.body.innerHTML;{const e=c.createElement("div");return e.id=a,e.innerHTML=c.body.innerHTML,e.outerHTML}}function U(t){const o=document.createElement("div");return o.textContent=t,o.innerHTML}function D(t,o,n){let s=t??"";return(s==null?void 0:s.length)===0&&o&&(s=U(o).split(`
`).map(a=>"<p>"+a+"</p>").join(`
`)),V(s,n??{})}const W=["innerHTML"],Y=["title"],z=i.defineComponent({__name:"Letter",props:{className:{},html:{},text:{},useIframe:{type:Boolean},iframeTitle:{},rewriteExternalLinks:{},rewriteExternalResources:{},allowedSchemas:{},preserveCssPriority:{type:Boolean}},setup(t){const o=t,{className:n,html:s,text:a,useIframe:r,iframeTitle:f,rewriteExternalLinks:y,rewriteExternalResources:c,allowedSchemas:k,preserveCssPriority:d}=i.reactive(o),C=D(s,a,{rewriteExternalResources:c,rewriteExternalLinks:y,allowedSchemas:k,preserveCssPriority:d}),M="data:text/html;charset=utf-8,"+encodeURIComponent(C);return(L,R)=>i.unref(r)?i.unref(r)?(i.openBlock(),i.createElementBlock("div",{key:1,class:i.normalizeClass([i.unref(n)])},[i.createElementVNode("iframe",{src:M,title:i.unref(f)},null,8,Y)],2)):i.createCommentVNode("",!0):(i.openBlock(),i.createElementBlock("div",{key:0,class:i.normalizeClass([i.unref(n)]),innerHTML:i.unref(C)},null,10,W))}}),$={install:t=>{t.component("Letter",z)}};g.Letter=z,g.default=$,Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
